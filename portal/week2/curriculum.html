<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 2 Workbook: The Sacred Flame - Forces 8-14</title>
    <style>
        /* [ALL EXISTING CSS REMAINS - ADD NEW STYLES BELOW] */
        
        /* Completion Certificate Styles */
        .completion-certificate {
            background: rgba(212, 175, 55, 0.1);
            padding: 50px 40px;
            border-radius: 20px;
            margin: 60px 0;
            border: 2px solid var(--primary-gold);
            text-align: center;
            position: relative;
        }
        
        .completion-certificate::before {
            content: 'ìÇÄ';
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 4em;
            opacity: 0.1;
        }
        
        .btn-complete {
            background: linear-gradient(135deg, var(--success-green) 0%, #2E7D32 100%);
            color: white;
            padding: 20px 45px;
            border-radius: 10px;
            border: none;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-complete:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(76, 175, 80, 0.3);
        }
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin: 40px 0;
            position: relative;
        }
        
        .progress-steps::before {
            content: '';
            position: absolute;
            top: 25px;
            left: 0;
            right: 0;
            height: 2px;
            background: rgba(212, 175, 55, 0.3);
            z-index: 1;
        }
        
        .step {
            text-align: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }
        
        .step-number {
            width: 50px;
            height: 50px;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            border: 2px solid rgba(212, 175, 55, 0.3);
            font-weight: 600;
        }
        
        .step.active .step-number {
            background: var(--primary-gold);
            color: var(--background-dark);
            border-color: var(--primary-gold);
        }
        
        .step.completed .step-number {
            background: var(--success-green);
            color: white;
            border-color: var(--success-green);
        }
        
        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(20, 0, 37, 0.95);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 20px;
            text-align: center;
        }
        
        .lock-screen.active {
            display: flex;
        }
    </style>
</head>
<body>
    <div class="workbook-container">
        <!-- Progress Steps -->
        <div class="progress-steps">
            <div class="step completed">
                <div class="step-number">1</div>
                <div>Study Forces 8-14</div>
            </div>
            <div class="step active">
                <div class="step-number">2</div>
                <div>Complete Exercises</div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div>Unlock Week 3</div>
            </div>
        </div>

        <!-- FORCE SECTIONS (your existing 7 forces sections go here) -->
        
        <!-- WEEK COMPLETION CERTIFICATE SECTION -->
        <div class="completion-certificate" id="completionSection">
            <h2 style="color:var(--primary-gold); font-family:'Cinzel', serif; margin-bottom:30px; font-size:2em; font-weight:600;">
                ìÇÄ Sacred Flame Completion
            </h2>
            
            <p style="max-width:700px; margin:30px auto; color:var(--text-secondary); font-size:1.1em;">
                By completing this workbook, you demonstrate mastery over Forces 8-14 of Ma'at and unlock access to Week 3: The Veil & Voice.
            </p>
            
            <div class="ritual-instruction" style="text-align:left; margin:40px auto; max-width:600px;">
                <p><strong>Completion Requirements:</strong></p>
                <ul>
                    <li>‚úì Complete all 7 Force exercises</li>
                    <li>‚úì Fill out all reflection fields</li>
                    <li>‚úì Perform the Week 2 sunrise practices</li>
                    <li>‚úì Participate in the completion ceremony</li>
                </ul>
            </div>
            
            <button class="btn-complete" onclick="completeWorkbook()" id="completeButton">
                ‚úÖ Mark Workbook as Complete
            </button>
            
            <div style="margin-top:40px; padding:20px; background:rgba(255,255,255,0.03); border-radius:10px; border:1px solid rgba(212, 175, 55, 0.2); max-width:600px; margin-left:auto; margin-right:auto;">
                <p style="color:var(--text-accent); font-size:0.9em;">
                    <strong>Note:</strong> Upon completion, you'll be able to access Week 3: The Veil & Voice. Your progress is permanently recorded.
                </p>
            </div>
        </div>
        
        <!-- MODIFIED NAVIGATION SECTION -->
        <div style="text-align: center; margin-top: 40px; padding-top: 40px; border-top: 1px solid rgba(255, 215, 0, 0.25);">
            <div class="nav-links">
                <a href="index.html" class="nav-button">
                    ‚Üê Return to Week 2 Overview
                </a>
                
                <!-- This link only appears when workbook is completed -->
                <a href="../week3/index.html" class="btn-primary" id="unlockWeek3Link" style="display: none; background: linear-gradient(135deg, var(--success-green) 0%, #2E7D32 100%); margin: 0 15px;">
                    üîì Unlock Week 3: The Veil & Voice ‚Üí
                </a>
                
                <button class="btn-secondary" onclick="saveProgress()">
                    üíæ Save My Progress
                </button>
            </div>
        </div>
        
        <!-- LOCK SCREEN -->
        <div class="lock-screen" id="lockScreen">
            <div style="font-size: 4em; margin-bottom: 20px; color: var(--primary-gold);">üîí</div>
            <h2 style="color: #FFD700; margin-bottom: 20px;">Week 3 is Locked</h2>
            <p style="color: #f7eaff; max-width: 600px; margin-bottom: 30px; font-size: 1.1em;">
                Complete the <strong>Week 2 Sacred Flame Workbook</strong> to unlock Week 3: The Veil & Voice.
            </p>
            <button class="btn-primary" onclick="hideLockScreen()" style="margin-bottom: 15px;">
                Continue Workbook
            </button>
            <a href="index.html" class="btn-secondary">
                ‚Üê Return to Week 2
            </a>
            <p style="margin-top: 30px; color: #8c78ff; font-size: 0.9em;">
                Your progress is automatically saved. Complete the workbook exercises to proceed.
            </p>
        </div>
    </div>

    <script>
        // Workbook completion function
        function completeWorkbook() {
            // Check if all required fields are filled (optional)
            const requiredFields = document.querySelectorAll('textarea, input[type="text"]');
            let emptyFields = 0;
            
            requiredFields.forEach(field => {
                if (field.value.trim() === '' && !field.placeholder.includes('optional')) {
                    emptyFields++;
                }
            });
            
            if (emptyFields > 0) {
                if (!confirm(`You have ${emptyFields} empty reflection fields. Mark as complete anyway?`)) {
                    return;
                }
            }
            
            // Mark workbook as completed in localStorage
            localStorage.setItem('week2_workbook_completed', 'true');
            localStorage.setItem('week2_completed_date', new Date().toISOString());
            
            // Update progress steps
            document.querySelectorAll('.step')[2].classList.add('completed');
            
            // Show success message
            showNotification('üéâ Sacred Flame Workbook Completed! Week 3 is now unlocked.', 'success');
            
            // Update completion section
            document.getElementById('completeButton').style.display = 'none';
            document.getElementById('unlockWeek3Link').style.display = 'inline-flex';
            
            // Update completion certificate
            const completionSection = document.getElementById('completionSection');
            completionSection.innerHTML = `
                <h2 style="color:var(--success-green); font-family:'Cinzel', serif; margin-bottom:30px; font-size:2em; font-weight:600;">
                    ‚úÖ Sacred Flame Completed
                </h2>
                
                <div style="font-size: 4em; margin: 30px 0; color: var(--primary-gold);">ìÇÄ</div>
                
                <p style="max-width:700px; margin:30px auto; color:var(--text-secondary); font-size:1.1em;">
                    <strong>Completion Date:</strong> ${new Date().toLocaleDateString()}<br>
                    <strong>Forces Mastered:</strong> 8-14 of Ma'at<br>
                    <strong>Next Gateway:</strong> Week 3 - The Veil & Voice
                </p>
                
                <div style="margin:40px auto; max-width:600px; background:rgba(76, 175, 80, 0.1); padding:25px; border-radius:10px; border:1px solid var(--success-green);">
                    <p style="color:var(--text-primary); font-family:'Cardo', serif; font-style:italic;">
                        "The flame that consumed deception now illuminates truth. You walk as living heka."
                    </p>
                </div>
                
                <a href="../week3/index.html" class="btn-primary" style="margin:20px; background: linear-gradient(135deg, var(--success-green) 0%, #2E7D32 100%);">
                    üîì Proceed to Week 3: The Veil & Voice ‚Üí
                </a>
                
                <a href="index.html" class="btn-secondary">
                    ‚Üê Return to Week 2 Overview
                </a>
            `;
            
            // Auto-redirect after 5 seconds
            setTimeout(() => {
                if (confirm('Workbook completed! Would you like to proceed to Week 3 now?')) {
                    window.location.href = '../week3/index.html';
                }
            }, 5000);
        }
        
        // Check workbook completion status
        function checkWorkbookStatus() {
            const workbookCompleted = localStorage.getItem('week2_workbook_completed');
            
            if (workbookCompleted === 'true') {
                // Update progress steps
                document.querySelectorAll('.step')[2].classList.add('completed');
                
                // Show unlock link
                document.getElementById('unlockWeek3Link').style.display = 'inline-flex';
                
                // Hide complete button
                document.getElementById('completeButton').style.display = 'none';
            }
        }
        
        function hideLockScreen() {
            document.getElementById('lockScreen').classList.remove('active');
        }
        
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'rgba(76, 175, 80, 0.9)' : 'rgba(255, 87, 87, 0.9)'};
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                z-index: 10000;
                font-family: 'Georgia', serif;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }
        
        function saveProgress() {
            const progress = {
                completed: localStorage.getItem('week2_workbook_completed'),
                date: localStorage.getItem('week2_completed_date'),
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('week2_progress_backup', JSON.stringify(progress));
            showNotification('üíæ Progress saved successfully!', 'success');
        }
        
        // Check completion on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkWorkbookStatus();
            
            // Check if coming from Week 3 without completion
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('locked') === 'true') {
                document.getElementById('lockScreen').classList.add('active');
            }
            
            // Intercept Week 3 navigation attempts
            document.querySelectorAll('a[href*="week3"]').forEach(link => {
                link.addEventListener('click', function(e) {
                    const workbookCompleted = localStorage.getItem('week2_workbook_completed');
                    
                    if (workbookCompleted !== 'true') {
                        e.preventDefault();
                        document.getElementById('lockScreen').classList.add('active');
                    }
                });
            });
        });
    </script>
</body>
</html>
