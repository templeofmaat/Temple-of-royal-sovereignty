<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 3 Workbook: The Veil & The Voice</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Georgia:ital,wght@0,400;0,700;1,400&display=swap');

        body {
            background: #140025;
            color: #f7eaff;
            font-family: "Georgia", serif;
            margin: 0;
            padding: 40px 20px;
            line-height: 1.7;
            min-height: 100vh;
        }

        h1, h2, h3, h4 {
            color: #FFD700;
            margin-top: 0;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .workbook-container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255,255,255,0.06);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid #FFD700;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .completion-section {
            background: rgba(76, 175, 80, 0.08);
            padding: 50px 40px;
            border-radius: 15px;
            margin: 50px 0;
            border: 2px solid #4CAF50;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .completion-section::before {
            content: "üåÄ";
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 4em;
            opacity: 0.1;
            color: #FFD700;
        }

        .btn-complete {
            background: #330066;
            color: #4CAF50;
            padding: 18px 45px;
            border-radius: 10px;
            border: 2px solid #4CAF50;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1em;
            margin: 20px 10px;
            transition: all 0.3s ease;
        }

        .btn-complete:hover {
            background: #4c0099;
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(76, 175, 80, 0.3);
        }

        .progress-tracker {
            display: flex;
            justify-content: space-between;
            margin: 40px 0;
            position: relative;
            padding: 20px;
            background: rgba(255,255,255,0.06);
            border-radius: 10px;
            border: 1px solid #FFD700;
        }

        .progress-tracker::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 10%;
            right: 10%;
            height: 2px;
            background: rgba(255, 215, 0, 0.3);
            z-index: 1;
            transform: translateY(-50%);
        }

        .progress-step {
            text-align: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .step-number {
            width: 50px;
            height: 50px;
            background: rgba(255, 215, 0, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            font-weight: 600;
            color: #FFD700;
        }

        .step-number.completed {
            background: #4CAF50;
            border-color: #4CAF50;
            color: white;
        }

        .step-number.active {
            background: #FFD700;
            border-color: #FFD700;
            color: #140025;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 215, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }

        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(20, 0, 37, 0.95);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 20px;
            text-align: center;
        }

        .lock-screen.active {
            display: flex;
        }

        .harmony-wheel {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(
                rgba(255, 215, 0, 0.3) 0deg 60deg,
                rgba(255, 215, 0, 0.5) 60deg 120deg,
                rgba(255, 215, 0, 0.3) 120deg 180deg,
                rgba(255, 215, 0, 0.5) 180deg 240deg,
                rgba(255, 215, 0, 0.3) 240deg 300deg,
                rgba(255, 215, 0, 0.5) 300deg 360deg
            );
            margin: 30px auto;
            position: relative;
            animation: spin 20s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .declaration {
            background: rgba(255, 215, 0, 0.08);
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            border-left: 5px solid #FFD700;
        }

        .exercise {
            background: rgba(255,255,255,0.06);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #FFD700;
        }

        .harmony-scale {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }

        .scale-point {
            flex: 1;
            text-align: center;
            padding: 15px;
            background: rgba(255,255,255,0.06);
            border-radius: 8px;
            border: 1px solid #FFD700;
        }

        .btn {
            background: #330066;
            color: #FFD700;
            padding: 15px 30px;
            border-radius: 8px;
            text-decoration: none;
            display: inline-block;
            margin: 10px;
            border: 2px solid #FFD700;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #4c0099;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        .btn-unlock {
            background: #330066;
            border-color: #4CAF50;
            color: #4CAF50;
            display: none;
        }

        .btn.gold {
            background: linear-gradient(135deg, #FFD700, #f7eaff);
            color: #140025;
            border-color: #FFD700;
        }

        .btn.gold:hover {
            background: linear-gradient(135deg, #f7eaff, #FFD700);
        }

        .btn.green {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border-color: #4CAF50;
        }

        .btn.green:hover {
            background: linear-gradient(135deg, #2E7D32, #4CAF50);
        }

        textarea, input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background: rgba(255,255,255,0.06);
            border: 1px solid #FFD700;
            color: #f7eaff;
            border-radius: 5px;
            font-family: inherit;
        }

        .unlocked-badge {
            display: inline-block;
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-left: 15px;
            border: 1px solid #4CAF50;
        }

        .navigation-container {
            background: rgba(255, 215, 0, 0.05);
            padding: 40px;
            border-radius: 15px;
            margin: 40px 0;
            border: 2px solid #FFD700;
            text-align: center;
        }

        .nav-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .nav-btn {
            display: inline-block;
            background: linear-gradient(135deg, 
                #330066 0%,
                #4c0099 50%,
                #330066 100%);
            color: #FFD700;
            padding: 15px 30px;
            border-radius: 12px;
            text-decoration: none;
            border: 2px solid #FFD700;
            font-weight: bold;
            font-size: 1.1em;
            transition: all 0.3s ease;
            min-width: 200px;
            text-align: center;
        }

        .nav-btn:hover {
            background: linear-gradient(135deg,
                #4c0099 0%,
                #6600cc 50%,
                #4c0099 100%);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }

        .nav-btn.gold {
            background: linear-gradient(135deg, 
                #FFD700 0%,
                #f7eaff 50%,
                #FFD700 100%);
            color: #140025;
        }

        .nav-btn.gold:hover {
            background: linear-gradient(135deg,
                #f7eaff 0%,
                #FFD700 50%,
                #f7eaff 100%);
        }

        @media (max-width: 768px) {
            .harmony-scale {
                flex-direction: column;
                gap: 15px;
            }
            .nav-buttons {
                flex-direction: column;
                align-items: center;
            }
            .nav-btn {
                min-width: 150px;
                padding: 12px 20px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <!-- Lock Screen for Week 4 -->
    <div class="lock-screen" id="lockScreen">
        <div style="font-size: 4em; margin-bottom: 20px; color: #FFD700;">üîí</div>
        <h2 style="color: #FFD700; margin-bottom: 20px; font-size: 2.2em;">Week 4 is Locked</h2>
        <p style="color: #f7eaff; max-width: 600px; margin-bottom: 30px; font-size: 1.1em;">
            Complete the <strong>Week 3: The Veil & The Voice Workbook</strong> to unlock Week 4: The Solar Path.
        </p>
        
        <div class="progress-tracker" style="max-width: 500px; background: transparent;">
            <div class="progress-step">
                <div class="step-number completed">‚úì</div>
                <div>Week 2<br>Sacred Flame</div>
            </div>
            <div class="progress-step">
                <div class="step-number active">3</div>
                <div>Week 3<br>The Veil & The Voice</div>
            </div>
            <div class="progress-step">
                <div class="step-number">4</div>
                <div>Week 4<br>The Solar Path</div>
            </div>
        </div>
        
        <div style="margin: 40px 0; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
            <button class="btn" onclick="hideLockScreen()" style="padding: 18px 35px;">
                Continue Week 3 Workbook
            </button>
            <a href="../week3/index.html" class="btn" style="background: rgba(255, 215, 0, 0.1);">
                ‚Üê Return to Week 3
            </a>
        </div>
        
        <p style="margin-top: 30px; color: #FFD700; font-size: 0.9em; max-width: 500px;">
            <em>Your progress saves automatically. Complete all Week 3 harmony exercises to unlock the Solar Path.</em>
        </p>
    </div>
    
    <div class="workbook-container">
        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-step">
                <div class="step-number completed">1</div>
                <div>Week 2 Workbook</div>
            </div>
            <div class="progress-step">
                <div class="step-number active">2</div>
                <div>Complete Week 3</div>
            </div>
            <div class="progress-step">
                <div class="step-number" id="step3">3</div>
                <div>Unlock Week 4</div>
            </div>
        </div>
        
        <div style="text-align:center;">
            <h1 style="color:#FFD700;">The Veil & The Voice</h1>
            <p style="color:#FFD700;">Week 3: Harmony-Keeper's Gateway</p>
            <div class="harmony-wheel"></div>
        </div>
        
        <!-- Day 1: Declaration 13 -->
        <div class="declaration">
            <h3 style="color:#FFD700;">üåÄ Declaration 13: "I have not caused chaos"</h3>
            <p><em>I create structure where there is confusion</em></p>
        </div>
        
        <div class="exercise">
            <h4>Exercise 3.1: Chaos to Order Assessment</h4>
            <p><strong>Step 1:</strong> Identify 3 areas of chaos in your life:</p>
            <textarea placeholder="1. 2. 3." rows="3" id="chaos1"></textarea>
            
            <p><strong>Step 2:</strong> For each, what small action brings order?</p>
            <textarea placeholder="Your plan for order..." rows="3" id="order1"></textarea>
            
            <p><strong>Step 3:</strong> Implement one order-bringing action today:</p>
            <input type="text" placeholder="Today's order action" id="action1">
        </div>
        
        <!-- Day 2: Declaration 14 -->
        <div class="declaration">
            <h3 style="color:#FFD700;">üåä Declaration 14: "I have not disrupted natural flow"</h3>
            <p><em>I move with life's currents, not against them</em></p>
        </div>
        
        <div class="exercise">
            <h4>Exercise 3.2: Flow Assessment</h4>
            <div class="harmony-scale">
                <div class="scale-point">
                    <h5>Where I Flow</h5>
                    <textarea placeholder="Activities that feel effortless..." rows="3" id="flow1"></textarea>
                </div>
                <div class="scale-point">
                    <h5>Where I Force</h5>
                    <textarea placeholder="Activities that feel forced..." rows="3" id="force1"></textarea>
                </div>
            </div>
            
            <p><strong>Daily Practice:</strong> Choose one "forcing" activity to approach with flow today:</p>
            <input type="text" placeholder="Today's flow practice" id="flowPractice1">
        </div>
        
        <!-- Day 3: Declaration 15 -->
        <div class="declaration">
            <h3 style="color:#FFD700;">‚öñÔ∏è Declaration 15: "I have not been immoderate"</h3>
            <p><em>I find the middle way between all extremes</em></p>
        </div>
        
        <div class="exercise">
            <h4>Exercise 3.3: The Middle Way Practice</h4>
            <p><strong>Identify extremes in your life:</strong></p>
            <table style="width:100%; margin:20px 0;">
                <tr>
                    <th style="text-align:left; padding:10px;">Area</th>
                    <th style="text-align:left; padding:10px;">Extreme 1</th>
                    <th style="text-align:left; padding:10px;">Extreme 2</th>
                    <th style="text-align:left; padding:10px;">Middle Way</th>
                </tr>
                <tr>
                    <td style="padding:10px;">Work/Rest</td>
                    <td style="padding:10px;"><input type="text" placeholder="Overworking" style="width:100%;" id="extreme1"></td>
                    <td style="padding:10px;"><input type="text" placeholder="Laziness" style="width:100%;" id="extreme2"></td>
                    <td style="padding:10px;"><input type="text" placeholder="Balanced rhythm" style="width:100%;" id="middle1"></td>
                </tr>
                <tr>
                    <td style="padding:10px;">Social/Solitude</td>
                    <td style="padding:10px;"><input type="text" placeholder="Always social" style="width:100%;" id="extreme3"></td>
                    <td style="padding:10px;"><input type="text" placeholder="Always alone" style="width:100%;" id="extreme4"></td>
                    <td style="padding:10px;"><input type="text" placeholder="Healthy balance" style="width:100%;" id="middle2"></td>
                </tr>
            </table>
        </div>
        
        <!-- Harmony Tracker -->
        <div class="exercise" style="background:rgba(255,255,255,0.06); border:1px solid #FFD700;">
            <h4>üìä Weekly Harmony Tracker</h4>
            <p>Rate your harmony levels (1-10) each day:</p>
            <table style="width:100%; border-collapse:collapse;">
                <thead>
                    <tr style="background:rgba(255,215,0,0.1)">
                        <th style="padding:10px;">Day</th>
                        <th style="padding:10px;">Internal Harmony</th>
                        <th style="padding:10px;">Relational Harmony</th>
                        <th style="padding:10px;">Environmental Harmony</th>
                        <th style="padding:10px;">Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td style="padding:10px;">Mon</td>
                        <td style="padding:10px;"><input type="number" min="1" max="10" style="width:60px;" id="harmony1"></td>
                        <td style="padding:10px;"><input type="number" min="1" max="10" style="width:60px;" id="harmony2"></td>
                        <td style="padding:10px;"><input type="number" min="1" max="10" style="width:60px;" id="harmony3"></td>
                        <td style="padding:10px;"><input type="text" style="width:100%;" id="notes1"></td></tr>
                    <tr><td style="padding:10px;">Tue</td>
                        <td style="padding:10px;"><input type="number" min="1" max="10" style="width:60px;" id="harmony4"></td>
                        <td style="padding:10px;"><input type="number" min="1" max="10" style="width:60px;" id="harmony5"></td>
                        <td style="padding:10px;"><input type="number" min="1" max="10" style="width:60px;" id="harmony6"></td>
                        <td style="padding:10px;"><input type="text" style="width:100%;" id="notes2"></td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- Harmony Ceremony -->
        <div class="exercise" style="background:rgba(255, 215, 0, 0.08); border:2px solid #FFD700;">
            <h4>üåÄ Day 7: The Harmony Ritual</h4>
            <p><strong>Step 1:</strong> Create a harmonious space (clean, orderly, peaceful)</p>
            <p><strong>Step 2:</strong> Light blue candle. Play gentle music if desired</p>
            <p><strong>Step 3:</strong> Speak aloud: "I am harmony. I create peace. I balance all things."</p>
            <p><strong>Step 4:</strong> Read Harmony Declarations 13-18 with feeling</p>
            <p><strong>Step 5:</strong> Chant "Om" or hum for 7 minutes</p>
            
            <p><strong>Ritual Reflection:</strong></p>
            <textarea placeholder="How did you feel during the ritual? What shifted?" rows="4" id="ritualReflection"></textarea>
        </div>
        
        <!-- COMPLETION SECTION -->
        <div class="completion-section" id="completionSection">
            <h2 style="color: #4CAF50; margin-bottom: 20px;">‚öñÔ∏è Week 3 Completion</h2>
            <p style="max-width: 700px; margin: 20px auto; color: #f7eaff;">
                Complete all harmony exercises to unlock Week 4: The Solar Path.
            </p>
            
            <div style="background: rgba(255,255,255,0.06); padding: 20px; border-radius: 10px; max-width: 600px; margin: 30px auto; border: 1px solid #4CAF50;">
                <p><strong>Completion Requirements:</strong></p>
                <ul style="text-align: left; display: inline-block;">
                    <li>‚úì Complete all harmony declarations 13-15</li>
                    <li>‚úì Fill out at least 5 reflection fields</li>
                    <li>‚úì Complete the harmony tracker</li>
                    <li>‚úì Perform the Day 7 harmony ritual</li>
                </ul>
           
        </div>
        
        <!-- FINAL NAVIGATION SECTION - AT THE VERY BOTTOM -->
        <div class="navigation-container">
            <h3 style="color: #FFD700; margin-bottom: 20px; font-size: 1.8em;">ìçπ NAVIGATION & COMPLETION ìçπ</h3>
            
            <!-- Week 3 Resources -->
            <div style="background: rgba(255,255,255,0.06); padding: 25px; border-radius: 12px; margin: 25px 0; border: 1px solid #FFD700;">
                <h4 style="color: #FFD700; margin-bottom: 15px;">üìö Week 3 Resources</h4>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 15px;">
                    <button class="btn" onclick="generatePDF(3)">üì• Download Complete PDF</button>
                    <button class="btn" onclick="window.print()">üñ®Ô∏è Print Workbook</button>
                </div>
            </div>
            
            <!-- Completion Navigation -->
 </div>
            
            <button class="btn-complete" onclick="completeWorkbook()" id="completeButton">
                ‚úÖ Mark Week 3 Workbook as Complete
            </button>
            
            <div style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.06); border-radius: 10px; border: 1px solid rgba(255, 215, 0, 0.2); max-width: 600px; margin-left: auto; margin-right: auto;">
                <p style="color: #FFD700; font-size: 0.9em;">
                    <strong>Note:</strong> Upon completion, Week 4: The Solar Path will unlock automatically.
                </p>
            </div>
            
            <div style="background: rgba(76, 175, 80, 0.08); padding: 30px; border-radius: 12px; margin: 30px 0; border: 1px solid #4CAF50;">
                <h4 style="color: #4CAF50; margin-bottom: 15px;">‚ö° Continue Your Journey</h4>
                <p style="color: #f7eaff; margin-bottom: 20px; font-size: 1.1em;">
                    Complete Week 3 to unlock the next stage of your path.
                </p>
                
                <div class="nav-buttons">
                    <!-- This button is shown only after completion -->
                    <a href="../week4/index.html" class="nav-btn gold" id="continueWeek4Link" style="display: none;">
                        <span style="font-size: 1.3em;">üîì</span><br>
                        Continue to Week 4<br>
                        <small>The Solar Path</small>
                    </a>
                    
                    <a href="../week3/index.html" class="nav-btn">
                        <span style="font-size: 1.3em;">üìñ</span><br>
                        Back to Week 3 Review<br>
                        <small>Forces 15-21</small>
                    </a>
                    
                    <a href="../hall-of-truth.html" class="nav-btn">
                        <span style="font-size: 1.3em;">üèõÔ∏è</span><br>
                        Return to Hall of Truth<br>
                    </a>
                </div>
                
                <!-- Completion Status -->
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid rgba(255,215,0,0.3);">
                    <p style="color: #FFD700; font-style: italic; margin-bottom: 10px;">Completion Status:</p>
                    <div id="completionStatus" style="color: #f7eaff;">
                        <p>Week 3: <span id="week3Status">In Progress</span></p>
                        <p>Week 4: <span id="week4Status">Locked üîí</span></p>
                    </div>
                </div>
            </div>
            
            <p style="margin-top: 30px; color: #FFD700; font-size: 0.9em; max-width: 600px; margin-left: auto; margin-right: auto;">
                <em>Your progress saves automatically. Complete Week 3 to unlock Week 4: The Solar Path.</em>
            </p>
        </div>
    </div>

    <script>
        // Workbook completion function
        function completeWorkbook() {
            // Check if enough fields are filled
            const requiredFields = document.querySelectorAll('textarea, input[type="text"], input[type="number"]');
            let filledFields = 0;
            
            requiredFields.forEach(field => {
                if (field.value.trim() !== '') {
                    filledFields++;
                }
            });
            
            if (filledFields < 5) {
                if (!confirm(`You have ${filledFields} filled fields (minimum 5 recommended). Mark as complete anyway?`)) {
                    return;
                }
            }
            
            // Mark workbook as completed
            localStorage.setItem('balance_of_opposites_completed', 'true');
            localStorage.setItem('week3_completed_date', new Date().toISOString());
            
            // Update progress tracker
            document.getElementById('step3').classList.add('completed');
            
            // Show success message
            showNotification('‚úÖ Week 3 Workbook Completed! Week 4 is now unlocked.', 'success');
            
            // Update completion section
            document.getElementById('completeButton').style.display = 'none';
            
            // Show the Week 4 link in navigation
            document.getElementById('continueWeek4Link').style.display = 'inline-block';
            
            // Update completion status
            document.getElementById('week3Status').innerHTML = 'Completed ‚úÖ';
            document.getElementById('week4Status').innerHTML = 'Unlocked üîì';
            
            // Update completion section content
            const completionSection = document.getElementById('completionSection');
            completionSection.innerHTML = `
                <h2 style="color: #4CAF50; margin-bottom: 20px; font-size: 2em;">‚úÖ Week 3 Complete</h2>
                
                <div style="font-size: 3em; margin: 20px 0; color: #FFD700;">‚öñÔ∏è</div>
                
                <div style="background: rgba(76, 175, 80, 0.08); padding: 25px; border-radius: 10px; max-width: 500px; margin: 20px auto; border: 1px solid #4CAF50;">
                    <p style="color: #f7eaff; font-size: 1.1em; margin: 0;">
                        <strong>Completion Date:</strong> ${new Date().toLocaleDateString()}<br>
                        <strong>Forces Mastered:</strong> 15-21 of Ma'at<br>
                        <strong>Harmony Achieved:</strong> Internal ‚Ä¢ Relational ‚Ä¢ Environmental
                    </p>
                </div>
                
                <div style="margin: 30px 0; max-width: 500px; margin-left: auto; margin-right: auto;">
                    <p style="color: #FFD700; font-style: italic;">
                        "You have achieved balance. The scales are even. The Solar Path awaits."
                    </p>
                </div>
                
                <div style="margin-top: 30px; padding: 20px; background: rgba(76, 175, 80, 0.08); border-radius: 10px; border: 1px solid #4CAF50; max-width: 500px; margin-left: auto; margin-right: auto;">
                    <p style="color: #4CAF50; font-weight: bold;">
                        ‚úÖ Week 4: The Solar Path is now unlocked!
                    </p>
                    <p style="color: #f7eaff; font-size: 0.9em;">
                        Proceed to the navigation section below to continue your journey.
                    </p>
                </div>
            `;
        }
        
        // Check workbook completion status
        function checkWorkbookStatus() {
            const workbookCompleted = localStorage.getItem('balance_of_opposites_completed');
            
            if (workbookCompleted === 'true') {
                // Update progress steps
                document.getElementById('step3').classList.add('completed');
                
                // Show the Week 4 link in navigation
                document.getElementById('continueWeek4Link').style.display = 'inline-block';
                
                // Hide complete button
                document.getElementById('completeButton').style.display = 'none';
                
                // Update completion status
                document.getElementById('week3Status').innerHTML = 'Completed ‚úÖ';
                document.getElementById('week4Status').innerHTML = 'Unlocked üîì';
                
                // Update completion section
                const completionDate = localStorage.getItem('week3_completed_date');
                const formattedDate = completionDate ? new Date(completionDate).toLocaleDateString() : 'Not set';
                
                const completionSection = document.getElementById('completionSection');
                completionSection.innerHTML = `
                    <h2 style="color: #4CAF50; margin-bottom: 20px; font-size: 2em;">‚úÖ Week 3 Complete</h2>
                    
                    <div style="font-size: 3em; margin: 20px 0; color: #FFD700;">‚öñÔ∏è</div>
                    
                    <div style="background: rgba(76, 175, 80, 0.08); padding: 25px; border-radius: 10px; max-width: 500px; margin: 20px auto; border: 1px solid #4CAF50;">
                        <p style="color: #f7eaff; font-size: 1.1em; margin: 0;">
                            <strong>Completion Date:</strong> ${formattedDate}<br>
                            <strong>Forces Mastered:</strong> 15-21 of Ma'at<br>
                            <strong>Harmony Achieved:</strong> Internal ‚Ä¢ Relational ‚Ä¢ Environmental
                        </p>
                    </div>
                    
                    <div style="margin: 30px 0; max-width: 500px; margin-left: auto; margin-right: auto;">
                        <p style="color: #FFD700; font-style: italic;">
                            "You have achieved balance. The scales are even. The Solar Path awaits."
                        </p>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: rgba(76, 175, 80, 0.08); border-radius: 10px; border: 1px solid #4CAF50; max-width: 500px; margin-left: auto; margin-right: auto;">
                        <p style="color: #4CAF50; font-weight: bold;">
                            ‚úÖ Week 4: The Solar Path is now unlocked!
                        </p>
                        <p style="color: #f7eaff; font-size: 0.9em;">
                            Proceed to the navigation section below to continue your journey.
                        </p>
                    </div>
                `;
            }
            
            // Check if coming from Week 4 without completion
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('locked') === 'true') {
                document.getElementById('lockScreen').classList.add('active');
            }
        }
        
        function hideLockScreen() {
            document.getElementById('lockScreen').classList.remove('active');
        }
        
        // Auto-save functionality
        function saveAllReflections() {
            const reflections = {};
            document.querySelectorAll('textarea, input[type="text"], input[type="number"]').forEach((el, index) => {
                reflections[`week3_reflection_${index}`] = el.value;
                localStorage.setItem(`balance_workbook_${index}`, el.value);
            });
            return reflections;
        }
        
        // Auto-save every 30 seconds
        setInterval(saveAllReflections, 30000);
        
        // Save on input
        document.querySelectorAll('textarea, input').forEach((el, index) => {
            el.addEventListener('input', function() {
                localStorage.setItem(`balance_workbook_${index}`, this.value);
            });
            
            // Load saved reflections
            const saved = localStorage.getItem(`balance_workbook_${index}`);
            if (saved) {
                el.value = saved;
            }
        });
        
        function generatePDF(week) {
            const content = `Week ${week} Harmony Workbook\n\nExercises Completed. For full PDF, complete all fields and use print function.`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Week${week}_Harmony_Workbook.txt`;
            a.click();
            
            showNotification('Workbook content saved! For complete PDF, use print function.', 'success');
        }
        
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 30px;
                right: 30px;
                background: ${type === 'success' ? 'linear-gradient(135deg, #4CAF50, #2E7D32)' : 'linear-gradient(135deg, #FFD700, #f7eaff)'};
                color: ${type === 'success' ? 'white' : '#140025'};
                padding: 20px 30px;
                border-radius: 10px;
                font-family: inherit;
                z-index: 10000;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                animation: slideIn 0.3s ease;
                max-width: 300px;
                border: 2px solid ${type === 'success' ? '#4CAF50' : '#FFD700'};
            `;
            
            notification.innerHTML = `
                <strong>${type === 'success' ? '‚úì' : '‚ö†'}</strong>
                <div style="margin-top: 10px; font-size: 0.9em;">${message}</div>
            `;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
            
            // Add CSS for animations
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // Check completion on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkWorkbookStatus();
            
            // Show lock screen if trying to access Week 4 from navigation
            const week4Links = document.querySelectorAll('a[href*="week4"]');
            week4Links.forEach(link => {
                link.addEventListener('click', function(e) {
                    const workbookCompleted = localStorage.getItem('balance_of_opposites_completed');
                    
                    if (workbookCompleted !== 'true' && !this.classList.contains('gold')) {
                        e.preventDefault();
                        document.getElementById('lockScreen').classList.add('active');
                    }
                });
            });
            
            // Initial save
            saveAllReflections();
        });
    </script>
</body>
</html>
